# This file was generated by Chef for <%= node['fqdn'] %>
# Do NOT modify this file by hand!

<% node[:nmdvarnish][:backend].each do |host, data| %>
backend <%= host %> {
  .host = "<%= data['host'] %>";
  .port = "<%= data['port'] %>";
}
<% end %>

<% unless node[:nmdvarnish][:director].nil?  -%>
<% node[:nmdvarnish][:director].each do |name, data| %>
  <% data.each do |type, type_data| %>
director <%= name %> <%= type %> {
  <% type_data.each do |k| %>
<% k.each do |l| %>  <%= l %>
<% end %>
<% end %>
}
    <% end %>
  <% end %>

<% end %>

<% unless node[:nmdvarnish][:acl].nil?  -%>
<% node[:nmdvarnish][:acl].each do |name, address| %>
acl <%= name %> {
  <% address.each do |a| %>
    <%= a %>
  <% end %>
  }
<% end %>
<% end %>

#<% unless node[:nmdvarnish][:vcl_recv].nil?  -%>
sub vcl_recv {
<% node[:nmdvarnish][:vcl_recv].each do |line| %>
<%= line %>
<% end %>
}

<% end %>
<% unless node[:nmdvarnish][:vcl_fetch].nil?  %>
sub vcl_fetch {
<% node[:nmdvarnish][:vcl_fetch].each do |line| %>
<%= line %>
<% end %>
}

<% end %>
<% unless node[:nmdvarnish][:vcl_hash].nil?  -%>
sub vcl_hash {
<% node[:nmdvarnish][:vcl_hash].each do |line| %>
<%= line %>
<% end %>
}

<% end %>
<% unless node[:nmdvarnish][:vcl_hit].nil?  -%>
sub vcl_hit {
<% node[:nmdvarnish][:vcl_hit].each do |line| %>
<%= line %>
<% end %>
}

<% end %>
<% unless node[:nmdvarnish][:vcl_miss].nil?  -%>
sub vcl_miss {
<% node[:nmdvarnish][:vcl_miss].each do |line| %>
<%= line %>
<% end %>
}

<% end %>
<% unless node[:nmdvarnish][:vcl_pass].nil?  -%>
sub vcl_pass {
<% node[:nmdvarnish][:vcl_pass].each do |line| %>
<%= line %>
<% end %>
}

<% end %>
<% unless node[:nmdvarnish][:vcl_deliver].nil?  -%>
sub vcl_deliver {
<% node[:nmdvarnish][:vcl_deliver].each do |line| %>
<%= line %>
<% end %>
}

<% end %>
<% unless node[:nmdvarnish][:vcl_error].nil?  -%>
sub vcl_error {
<% node[:nmdvarnish][:vcl_error].each do |line| %>
<%= line %>
<% end %>
}

<% end %>
