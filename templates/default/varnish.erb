# This file was generated by Chef for <%= node['fqdn'] %>
# Do NOT modify this file by hand!

# Configuration file for varnish
#
# /etc/init.d/varnish expects the variables $DAEMON_OPTS, $NFILES and $MEMLOCK
# to be set from this shell script fragment.
#

# Should we start varnishd at boot?
START=<%= node['nmdvarnish']['start'] %>

# Maximum number of open files (for ulimit -n)
NFILES=<%= node['nmdvarnish']['nfiles'] %>

# Maximum locked memory size (for ulimit -l)
MEMLOCK=<%= node['nmdvarnish']['memlock'] %>

# Default varnish instance name is the local nodename.
INSTANCE=<%= node['nmdvarnish']['instance'] %>


DAEMON_OPTS="-a <%= node['nmdvarnish']['listen.address'] %>:<%= node['nmdvarnish']['listen.port'] %> \
             -T <%= node['nmdvarnish']['management.hostname'] %>:<%= node['nmdvarnish']['management.port'] %> \
             -f <%= node['nmdvarnish']['vcl.file'] %> \
             -t <%= node['nmdvarnish']['default.ttl'] %> \
             -w <%= node['nmdvarnish']['threads.min'] %>,<%= node['nmdvarnish']['threads.max'] %>,<%= node['nmdvarnish']['threads.timeout'] %> \
             -S <%= node['nmdvarnish']['secretfile'] %> \
             -s <%= node['nmdvarnish']['storage.type'] %>,<%= node['nmdvarnish']['storage.options'] %>"
